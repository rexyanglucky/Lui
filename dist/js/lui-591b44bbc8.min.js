function LuiCheckBox(){this.selector="luicheck",this.param={}}function LuiDropDownList(){this.param=null,this.selector=""}function Lui(){this.checkBox=null}function LuiTree(){function t(t,e,i,c,l,n){function s(t,e){for(var i=[],c=0;c<t.length;c++){var l=t[c];l[a.parentField]===e&&i.push(l)}return i}var r="";e||(e=t[0]);var d=a.nameField||"name",o=a.idField||"id",h=a.warpid||"tree_1",u=s(t,i),p=c>=a.showlevel||0;if(u.length>0){r+=l==n-1?'<li class="parent-last">':"<li>",r+=p?'<i class="icon icon_op close"></i>':'<i class="icon icon_op open"></i>',r+=a.showParentCheckBox?'<luicheck class="lui_checkbox"  data-type="parent" data-showcheckbox="0" data-name="'+h+'" data-level="'+c+"\" data-json='"+escape(JSON.stringify(e))+"'  data-val=\""+e[o]+'" data-text="'+e[d]+'" data-checked="0"></luicheck>':'<luicheck class="lui_checkbox"  data-type="parent" data-showcheckbox="1" data-name="'+h+'" data-level="'+c+"\" data-json='"+escape(JSON.stringify(e))+"'  data-val=\""+e[o]+'" data-text="'+e[d]+'" data-checked="0"></luicheck>',r+=p?'<ul class="dn">':"<ul>";for(var k=0;k<u.length;k++){var f=c+1;r+=arguments.callee(t,u[k],u[k][o],f,k,u.length)}r+="</ul>",r+="</li>"}else r+=l==n-1?'<li class="leaf-last">':'<li class="leaf">',r+=a.showCheckBox?'<luicheck class="lui_checkbox" data-type="leaf"  data-showcheckbox="0" data-name="'+h+'" data-level="'+c+"\" data-json='"+escape(JSON.stringify(e))+"'  data-val=\""+e[o]+'" data-text="'+e[d]+'" data-checked="0"></luicheck>':'<luicheck class="lui_checkbox" data-type="leaf"  data-showcheckbox="1" data-name="'+h+'" data-level="'+c+"\" data-json='"+escape(JSON.stringify(e))+"'  data-val=\""+e[o]+'" data-text="'+e[d]+'" data-checked="0"></luicheck>';return r}var a;this.selector="",this.param=null,this.init=function(e){if(e){e.showParentCheckBox=!e.isOnlyLeafCallBack,this.param=a=e;var i=a.data,c=(a.nameField||"name",a.idField||"id"),l=a.warpid||"tree_1";this.selector=this.warpid="#"+l;var n=t(i,i[0],i[0][c],0,0,i.length),s=$("#"+l);s.html("<ul>"+n+"</ul>"),s.addClass("lui_tree_warp"),s.find(".icon_op").click(function(){$(this).hasClass("close")?($(this).removeClass("close").addClass("open"),$(this).siblings("ul").show(200)):($(this).removeClass("open").addClass("close"),$(this).siblings("ul").hide(200))});var r=new Lui;return r.initCheckBox({group:l}),s.find("luicheck").click(function(){var t=$(this),e="leaf"==t.attr("data-type"),i=t.prev("i.icon_op");if(a.isOnlyLeafCallBack&&!e&&i)return void i.click();if(e||a.showParentCheckBox&&(r.checkBox.ischeckElement(this)?t.siblings("ul").find("luicheck").each(function(t,a){r.checkBox.ischeckElement(a)||(litem=a,lui.checkBox.setClickStyle(a))}):t.siblings("ul").find("luicheck").each(function(t,a){r.checkBox.ischeckElement(a)&&lui.checkBox.setClickStyle(a)})),a.selectedCallBack&&a.showCheckBox){var c=t.attr("data-name"),l=r.checkBox.getJsonValue(c);a.selectedCallBack(c,l)}}),this}}}function LuiWordSpeak(){this.selector="lui_wordspeak",this.param={}}LuiCheckBox.prototype={constructor:LuiCheckBox,init:function(t){var a=this;return t&&t.group&&(this.selector='luicheck[data-name="'+t.group+'"]'),this.param=t,$(this.selector).each(function(e,i){var c=1==$(i).attr("data-checked")?"check_sel":"",l=1!=$(i).attr("data-showcheckbox"),n=$(i).attr("data-text"),s='<i class="icon_check '+c+' "></i>',r='<span class="check_text"  onselectstart="return false;" >'+n+"</span>";s=l?s+r:r,$(i).append(s),$(i).css({cursor:"pointer"}),$(i).unbind("click"),$(i).bind("click",function(){var e=$(this).attr("data-checked");if(1==e?($(this).attr("data-checked",0),$(this).children("i").removeClass("check_sel")):($(this).attr("data-checked",1),$(this).children("i").addClass("check_sel")),t.callback){var c=$(i).attr("data-name"),l=a.getJsonValue(c);t.callback(c,l)}})}),this},setValue:function(t,a){$(this.selector).filter('[data-name="'+t+'"]').filter('[data-val="'+a+'"]').each(function(t,a){var e=$(a).attr("data-checked");1==e||$(a).click()})},getValue:function(t){var a=[];$(this.selector).filter('[data-name="'+t+'"]').each(function(t,e){var i=$(e).attr("data-checked");1==i&&a.push($(e).attr("data-val"))}),alert(a.join(","))},getJsonValue:function(t){var a=[];return $(this.selector).filter('[data-name="'+t+'"]').each(function(t,e){var i=$(e).attr("data-checked");if(1==i){var c=$(e).attr("data-json");c&&a.push(JSON.parse(unescape(c)))}}),a},ischeck:function(t,a){var e=$(this.selector).filter('[data-name="'+t+'"]').filter('[data-val="'+a+'"]')[0],i=$(e).attr("data-checked");return 1==i},ischeckElement:function(t){var a=$(t).attr("data-checked");return 1==a},setClickStyle:function(t){var a=$(t).attr("data-checked");1==a?($(t).attr("data-checked",0),$(t).children("i").removeClass("check_sel")):($(t).attr("data-checked",1),$(t).children("i").addClass("check_sel"))}};var dropcount=1e3;LuiDropDownList.prototype={constructor:LuiDropDownList,init:function(t){this.selector=this.warpid="#"+t.warpid;var a=t.warpid,e=t.data,i=t.width=t.width||180,c=t.height=t.height||200,l=t.subtextlength=t.subtextlength||5;t.valueField=t.valueField||"id",t.textField=t.textField||"name";var n=t.valueField,s=t.textField,r=t.selectedCallBack,d=(t.loadedCallBack,t.zindex);if(0===t.data.length){var o={};o[n]=-1,o[s]="",e.push(o),c=0}var h=t.defaultValue=t.defaultValue||e[0][n],u=t.defaultText=t.defaultValue||e[0][s];this.param=t;var p="<div class='dropdiv dn'>";p+='  <ul class="dropul" style="max-height:'+c+'px;overflow:auto;" data-id="'+h+'" data-name="'+u+'">';for(var k=0;k<e.length;k++){var f=e[k],v=f[s].length>l?f[s].substring(0,l)+"...":f[s],x="<li title="+f[s]+" data-index="+k+" data-id="+f[n]+" data-tag='"+JSON.stringify(e[k])+"'>"+v+"</li>";p+=x}p+="</ul>",p+="</div>";var m=' <span style="width: '+i+'px;" class="dib"><span data-type="dropdownlist_drop_span">'+u+'</span> <i class="num_down"></i></span>',w=$("#"+a);w.css({width:i}),w.addClass("lui_dropdownlist"),w.html(m),w.append(p),d&&(w.find(".dropdiv").css("z-index",d),w.attr("zindex",d)),w.addClass("btn_num_updown").addClass("btn_num_updown1").addClass("dib"),w.attr("title",u);var g=$("#"+a+" ul"),_=$("#"+a+" .dropdiv"),C=$("#"+a+" ul li"),b=w.find("span[data-type='dropdownlist_drop_span']");return w.click(function(){return g.is(":visible")?_.slideUp(200):($(".dropdiv").slideUp(200),_.slideDown(200)),!1}),$("body").click(function(){$(".dropdiv").slideUp(200)}),C.click(function(){var t=$(this).attr("data-id"),e=$(this).html(),i=$(this).attr("data-josn"),c=$(this).attr("title");return b.text(e),b.attr("data-id",t),b.attr("data-json",i),b.attr("title",c),w.attr("title",c),r&&r(a,t,c),_.slideUp(200),!1}),this.span=b,this.setValue(h),this},getValue:function(){if(this.param.data.length>0){var t=this.span;return{value:t.attr("data-id"),text:t.attr("title"),zindex:$(this.selector).attr("zindex")}}return{value:-1,text:""}},getSelectedJsonValue:function(){if(this.param.data.length>0){var t=this.span;return JSON.parse(t.attr("data-json"))}return null},setValue:function(t){for(var a,e="",i=this.span,c=0;c<this.param.data.length;c++){var l=this.param.data[c];if(l[this.param.valueField]==t){e=l[this.param.textField],a=l;break}}i.attr("data-id",t),i.attr("data-json",JSON.stringify(a)),i.attr("title",e),$(this.selector).attr("title",e);var n=t,s=e,r=e.length>this.param.subtextlength?e.substring(0,this.param.subtextlength)+"...":e;return i.text(r),this.param.loadedCallBack&&this.param.loadedCallBack(containerId,n,s),this}},Lui.prototype={constructor:Lui,initTree:function(t){var a=new LuiTree;return a.init(t)},initDropDownList:function(t){var a=new LuiDropDownList;return a.init(t)},initCheckBox:function(t){this.checkBox||(this.checkBox=new LuiCheckBox);var a=new LuiCheckBox;return a.init(t)},initWordSpeak:function(t){this.wordspeak||(this.wordspeak=new LuiWordSpeak);var a=new LuiWordSpeak;return a.init(t)}},LuiTree.prototype={constructor:LuiTree,setLocation:function(t){},getSelectedJsonValue:function(){if(this.param.showParentCheckBox||this.param.showParentCheckBox){var t=new Lui,a=lui.checkBox.getJsonValue();return t=null,a}},openNode:function(t,a,e){}},LuiWordSpeak.prototype={constructor:LuiWordSpeak,init:function(t){var a=this;t=t||{};var e='<div class="lui_div_speak" id="lui_div_speak"/>';return $("body").append(e),$(".lui_wordspeak").each(function(t,e){$(e).unbind("click"),$(e).bind("click",function(){a.play(e)})}),t.auto&&(t.loop=t.loop||1,t.loop>0&&$(".lui_wordspeak").each(function(e,i){a.play(i,t.loop)})),a.param=t,a},play:function(t,a,e){var i=this;if(a=a||1,e=e||1e3,a>0){var c=$(t).attr("data-src"),l=document.getElementById("lui_div_speak");l.innerHTML='<audio id="lui_audio_speak"><source src="'+c+'"></audio>';$("#lui_audio_speak")[0].play();if(1===a)var n=setInterval(function(){shapeAudio.ended&&(callback(),window.clearInterval(n))},10);a--}a>0&&setTimeout(function(){i.play(t,a-1)},e)}};